use lab042

select 
    max(объем_лекций) as MAX_LECTURE_HOURS,
    min(объем_лекций) as MIN_LECTURE_HOURS,
    avg(объем_лекций) as AVG_LECTURE_HOURS
from предметы;

select 
    max(объем_лекций) as MAX_LECTURE_HOURS,
    min(объем_лекций) as MIN_LECTURE_HOURS,
    avg(объем_лекций) as AVG_LECTURE_HOURS,
    sum(объем_лекций) as TOTAL_LECTURE_HOURS,
    count(*) as COUNT_SUBJECTS
from предметы;

select оценка as Оценка, count(*) as Количество
from записи_на_факультативы
where оценка between 6 and 9
group by оценка
order by оценка desc;

select 
    п.название_предмета,
    round(avg(cast(з.оценка as float)), 2) as Средняя_оценка
from записи_на_факультативы з
inner join предметы п on з.номер_предмета = п.номер_предмета
group by п.название_предмета;

select 
    п.название_предмета,
    round(avg(cast(з.оценка as float)), 2) as Средняя_оценка
from записи_на_факультативы з
inner join предметы п on з.номер_предмета = п.номер_предмета
where п.название_предмета in ('Химия', 'Физика')
group by п.название_предмета;

select 
    с.фамилия + с.имя as Студент,
    п.название_предмета,
    round(avg(cast(з.оценка as float)), 2) as Средняя_оценка
from записи_на_факультативы з
inner join студенты с on з.номер_студента = с.номер_студента
inner join предметы п on з.номер_предмета = п.номер_предмета
group by с.фамилия, с.имя, п.название_предмета;

select п.название_предмета, count(*) as Количество_записей
from записи_на_факультативы з
inner join предметы п on з.номер_предмета = п.номер_предмета
group by п.название_предмета
having sum(case when з.оценка in (8, 9) then 1 else 0 end) > 0
order by п.название_предмета;

select предметы.название_предмета, записи_на_факультативы.оценка,
round(avg(cast(записи_на_факультативы.оценка as float)), 2) as средняя_оценка
from записи_на_факультативы
inner join предметы on записи_на_факультативы.номер_предмета = предметы.номер_предмета
group by предметы.название_предмета, записи_на_факультативы.оценка

 --select предметы.объем_лекций, предметы.название_предмета,
 --sum(предметы.объем_лекций) [лекции сумма]
 --from предметы
 --group by предметы.объем_лекций, предметы.название_предмета

 --select предметы.объем_лабораторных_работ, count(*) as Колво_лаб
 --from предметы
 --inner join записи_на_факультативы on записи_на_факультативы.номер_предмета=предметы.номер_предмета
 --inner join студенты on записи_на_факультативы.номер_студента = студенты.номер_студента
 --where студенты.имя like '%Арсений%'
 --group by предметы.объем_лабораторных_работ

 --select предметы.название_предмета,
 --avg(записи_на_факультативы.оценка) [средняя]
 --from предметы
 --inner join записи_на_факультативы on предметы.номер_предмета=записи_на_факультативы.номер_предмета
 --group by предметы.название_предмета

 --select предметы.название_предмета, 
 --sum(записи_на_факультативы.оценка) [оценки]
 --from предметы
 --inner join записи_на_факультативы on предметы.номер_предмета=записи_на_факультативы.номер_предмета
 --group by предметы.название_предмета



